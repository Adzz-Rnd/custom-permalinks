var getHomeURL=document.getElementById("custom_permalinks_home_url"),getPermalink=document.getElementById("custom_permalink"),editPost="",isSaving="",lastIsSaving=!1;function focusPermalinkField(e){"use strict";e.target&&(e.target.style.color="#000")}function blurPermalinkField(e){"use strict";var t=document.getElementById("original-permalink");e.target&&(getPermalink.value=e.target.value,""!==e.target.value&&e.target.value!==t.value||(e.target.value=t.value,e.target.style.color="#ddd"))}function updateMetaBox(){"use strict";var e,t,a;editPost&&wpApiSettings&&wpApiSettings.nonce&&((e=document.getElementsByClassName("edit-post-post-link__preview-label"))&&e[0]&&e[0].parentNode.classList.add("cp-permalink-hidden"),(isSaving=editPost.isSavingMetaBoxes())===lastIsSaving||isSaving||(t=wp.data.select("core/editor").getEditedPostAttribute("id"),a=new XMLHttpRequest,lastIsSaving=isSaving,a.onreadystatechange=function(){var e,t,n;4===a.readyState&&200===a.status&&(e=JSON.parse(a.responseText),t=document.getElementById("custom-permalinks-add"),getPermalink.value=e.custom_permalink,""===e.custom_permalink&&(e.custom_permalink=e.original_permalink),n=e.preview_permalink?getHomeURL.value+e.preview_permalink:getHomeURL.value+e.custom_permalink,document.getElementById("custom-permalinks-post-slug").value=e.custom_permalink,document.getElementById("original-permalink").value=e.original_permalink,document.querySelector("#view-post-btn a")&&(document.querySelector("#view-post-btn a").href=n),document.querySelector("a.editor-post-preview")&&(document.querySelector("a.editor-post-preview").href=n),t&&"add"===t.value&&(document.getElementById("custom-permalinks-edit-box").style.display=""),document.querySelector(".components-notice__content a")&&(document.querySelector(".components-notice__content a").href="/"+e.custom_permalink))},a.open("GET",getHomeURL.value+"wp-json/custom-permalinks/v1/get-permalink/"+t,!0),a.setRequestHeader("Cache-Control","private, max-age=0, no-cache"),a.setRequestHeader("X-WP-NONCE",wpApiSettings.nonce),a.send()),lastIsSaving=isSaving)}function hideDefaultPermalink(){"use strict";var e=document.getElementsByClassName("edit-post-post-link__preview-label");e&&e[0]&&e[0].parentNode.classList.add("cp-permalink-hidden")}function permalinkContentLoaded(){"use strict";var e=document.getElementsByClassName("edit-post-post-link__preview-label"),t=document.getElementById("custom-permalinks-edit-box"),n=document.getElementById("custom-permalinks-post-slug");if(n&&(n.addEventListener("focus",focusPermalinkField),n.addEventListener("blur",blurPermalinkField)),t&&""===document.querySelector("#custom-permalinks-edit-box .inside").innerHTML.trim()&&(t.style.display="none"),wp.data){var a=document.getElementById("custom-permalinks-add"),i=document.querySelectorAll(".edit-post-sidebar .components-panel__header"),s=0,o=i.length;if(a&&"add"===a.value&&(t.style.display="none"),editPost=wp.data.select("core/edit-post"),wp.data.subscribe(updateMetaBox),e&&e[0]&&e[0].parentNode.classList.add("cp-permalink-hidden"),t.classList.contains("closed")&&t.classList.remove("closed"),i&&0<o)for(;s<o;)i[s].addEventListener("click",hideDefaultPermalink),s+=1}}document.addEventListener("DOMContentLoaded",permalinkContentLoaded);